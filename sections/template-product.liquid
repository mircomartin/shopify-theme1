<section class="container mx-auto my-0 md:my-14">
	<div class="grid grid-cols-1 md:grid-cols-2 gap-9">
		<div class="product--medias relative">
			<!--Labels-->
			<div class="absolute flex">
				{% for tag in product.tags %}
					{% if tag == 'sale' %}
					<span class="text-white bg-red-500 py-1 px-2.5 uppercase text-xs">SALE</span>
					{% endif %}
					{% if tag == 'new' %}
					<span class="text-white bg-black py-1 px-2.5 uppercase text-xs">NEW</span>
					{% endif %}
				{% endfor %}
			</div>

			<!--Desktop Gallery-->
			<div class="hidden md:flex md:flex-col md:gap-y-1">
				{% for media in product.media %}
					<div class="h-100 overflow-hidden">
						{% render 'product-media', media: media %}
					</div>
				{% endfor %}
			</div>
			<!--Mobile Gallery-->
			<div class="md:hidden mobile-gallery">
				<div class="swiper mobile">
					<div class="swiper-wrapper">
						{% for media in product.media %}
						<div class="swiper-slide">
							<div class="overflow-hidden">
								{% render 'product-media', media: media %}
							</div>
						</div>
						{% endfor %}
					</div>
					<div class="swiper-pagination"></div>
				</div>
			</div>
		</div>
		<div class="product--information px-4 md:px-0">
			{% form 'product', product %}
			
				<div class="flex flex-col gap-y-6">

					<!--Add Checkbox-->
					<span>{{ product.vendor | upcase }}</span>
					<!--Add Checkbox-->

					<h1 class="text-2xl tracking-widest">{{ product.title | upcase }}</h1>

					<!--Add Checkbox + Custom MF -->
					<span class="text-xs font-bold text-blue-700 uppercase">
						{% assign min = 10 %}
						{% assign max = 25 %}
						{% assign diff = max | minus: min %}
						{% assign randomNumber = "now" | date: "%N" | modulo: diff | plus: min %}
						{{ randomNumber }} People have this in their cart right now!
					</span>
					<!--Add Checkbox-->

					<div class="flex gap-1.5">
						{% assign product_price = product.selected_or_first_available_variant %}
						<span class="text-xl">{{ product_price.price | money }}</span>
						{% if product_price.compare_at_price > 0 %}
						<span class="text-xl line-through text-stone-500">{{ product_price.compare_at_price | money }}</span>							
						{% endif %}
					</div>

					<!--Create Block Klarma with + CM -->
					<div>
						{% if product_price.compare_at_price > product_price.price %}
							{% assign product_price_klarma = product_price.compare_at_price %}
						{% else %}
							{% assign product_price_klarma = product_price.price %}
						{% endif %} 
						
						{% assign results = product_price_klarma | divided_by: 4 %}
						<span class="text-xs border border-slate-300 p-1">4 interest-free payments of {{ results | money }} with <strong>Klarna</strong>.</span>
					</div>
					<!--Create Block Klarma with product metafield-->

					<div class="flex flex-col">
						{% if product_price.compare_at_price > product_price.price %}
						<span class="text-cyan-400 uppercase">{{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}% SAVINGS</span>
						{% endif %}
						<!--Create Meta Boolean-->
						<span class="text-green-400	uppercase">sustainable</span>
						<!--Create Meta Boolean-->
					</div>

					<div>
						{% unless product.has_only_default_variant %}
						<div data-url="{{ product.url }}" data-section="{{ section.id }}">
							{% for option in product.options_with_values %}
								<label for="Option-{{ section.id }}-{{ forloop.index0 }}" class="text-sm">{{ option.name | upcase }}:</label>
								<div class="my-2">
									<select 
										name="options[{{ option.name | escape | upcase }}]" 
										id="Option-{{ section.id }}-{{ forloop.index0 }}"
										class="w-1/3 p-2.5 border border-slate-300 bg-stone-100"
									>
										{% for value in option.values %}
											<option 
											value="{{ value | escape }}" 
											class="text-sm bg-stone-100"
											{% if option.selected_value == value %}
												selected="selected"
											{% endif %}
											>{{ value | upcase }}</option>
										{% endfor %}
									</select>
								</div>
							{% endfor %}
						</div>
						{% endunless %}
					</div>

					<div>
						<label class="uppercase" for="Quantity-{{ section.id }}">QTY:</label>
						<input class="bg-stone-100 border border-slate-300 p-2.5" type="number" name="quantity" id="Quantity-{{ section.id }}" value="1" min="1" max="10">
					</div>

					<!--Description-->
					<div x-data="{ open: false }">
						<span 
							@click="open = true"
							class="flex text-sm uppercase tracking-wider font-bold cursor-pointer"
						>
							Details:
							<span :class="open && 'hidden'">{% render 'icon-dropdown' %}</span>
          					<span :class="!open && 'hidden'">-</span>
						</span>
						<div
							x-show="open"
							@click.away="open = false"
						>
							<p>{{ product.description }}</p>
						</div>
					</div>

				</div>

			{% endform %}
		</div>
	</div>
</section>

<style type="text/css">
	.product--medias .mobile-gallery .swiper-pagination {
		bottom: 10px;
		text-align: left;
		left: 10px;
	}
	.product--medias .mobile-gallery .swiper-pagination .swiper-pagination-bullet {
		width: 16px;
    	height: 16px;
		border: 1px solid #d5d5d5;
		background: transparent;
		opacity: unset;
	}
	.product--medias .mobile-gallery .swiper-pagination .swiper-pagination-bullet.swiper-pagination-bullet-active {
		background: #d5d5d5;
	}
</style>

<script>
	const swiperMobile = new Swiper('.swiper.mobile', {
		// Optional parameters
		direction: 'horizontal',
		loop: true,
		slidesPerView: 1,
		autoplay: {
			delay: 5000,
		},
		pagination: {
			el: '.swiper-pagination',
			clickable: true
		},
	});
</script>